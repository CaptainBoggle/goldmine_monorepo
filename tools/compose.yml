services:

  # example-model:
  #   build:
  #     context: ..
  #     dockerfile: tools/example_model/Dockerfile
  #   container_name: example-model
  #   networks:
  #     - goldmine-network
  #   ports:
  #     - "6000:8000"  # each model needs its own port for access outside the container
  #     # To the other services, this will be accessible at http://example-model:8000/
  #     # but from the host, it will be at http://localhost:6000/

  phenotagger:
    build:
      context: ..
      dockerfile: tools/phenotagger/Dockerfile
    container_name: phenotagger
    networks:
      - goldmine-network
    ports:
      - "6001:8000"

  gpt2:
    build:
      context: ..
      dockerfile: tools/gpt2/Dockerfile
    container_name: gpt2
    networks:
      - goldmine-network
    ports:
      - "6002:8000"

  phenobert:
    build:
      context: ..
      dockerfile: tools/phenobert/Dockerfile
    container_name: phenobert
    networks:
      - goldmine-network
    ports:
      - "6003:8000"

  hpo-agent:
    build:
      context: ..
      dockerfile: tools/hpo-agent/Dockerfile
    container_name: hpo-agent
    networks:
      - goldmine-network
    ports:
      - "6004:8000"
    environment:
      - GOOG_API=${GOOG_API}  # Pass through the Google API key for Gemini
    volumes:
      - ./hpo-agent/hpo:/app/tools/hpo-agent/hpo
      - ./hpo-agent/hpo_vector_db:/app/tools/hpo-agent/hpo_vector_db
      - ./hpo-agent/huggingface:/app/huggingface

  fast_hpo_cr:
    build:
      context: ..
      dockerfile: tools/fast_hpo_cr/Dockerfile
    container_name: fast_hpo_cr
    networks:
      - goldmine-network
    ports:
      - "6005:8000"
